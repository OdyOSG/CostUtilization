% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CalculateCostOfCare.R,
%   R/CalculateCostOfCareWithCpi.R
\name{calculateCostOfCare}
\alias{calculateCostOfCare}
\title{Calculate Cost of Care Analysis}
\usage{
calculateCostOfCare(
  connection = NULL,
  connectionDetails = NULL,
  cdmDatabaseSchema,
  cohortDatabaseSchema,
  cohortTable,
  cohortId,
  anchorCol = c("cohort_start_date", "cohort_end_date"),
  startOffsetDays = 0L,
  endOffsetDays = 90L,
  restrictVisitConceptIds = NULL,
  eventFilters = NULL,
  microCosting = FALSE,
  costConceptId = 31978L,
  currencyConceptId = 44818668L,
  primaryEventFilterName = NULL,
  targetDialect = NULL,
  tempEmulationSchema = NULL,
  asPermanent = FALSE,
  returnFormat = c("tibble", "list"),
  verbose = TRUE,
  logger = NULL,
  cpiAdjustment = FALSE,
  cpiTargetYear = NULL,
  cpiDataPath = NULL
)

calculateCostOfCare(
  connection = NULL,
  connectionDetails = NULL,
  cdmDatabaseSchema,
  cohortDatabaseSchema,
  cohortTable,
  cohortId,
  anchorCol = c("cohort_start_date", "cohort_end_date"),
  startOffsetDays = 0L,
  endOffsetDays = 90L,
  restrictVisitConceptIds = NULL,
  eventFilters = NULL,
  microCosting = FALSE,
  costConceptId = 31978L,
  currencyConceptId = 44818668L,
  primaryEventFilterName = NULL,
  targetDialect = NULL,
  tempEmulationSchema = NULL,
  asPermanent = FALSE,
  returnFormat = c("tibble", "list"),
  verbose = TRUE,
  logger = NULL,
  cpiAdjustment = FALSE,
  cpiTargetYear = NULL,
  cpiDataPath = NULL
)
}
\arguments{
\item{connection}{DatabaseConnector connection object}

\item{connectionDetails}{An R object of type \code{connectionDetails} created by the
\code{DatabaseConnector::createConnectionDetails} function.}

\item{cdmDatabaseSchema}{Schema name for CDM tables}

\item{cohortDatabaseSchema}{Schema name for cohort table}

\item{cohortTable}{Name of the cohort table}

\item{cohortId}{Cohort definition ID to analyze}

\item{anchorCol}{Column to use as anchor for time window ("cohort_start_date" or "cohort_end_date")}

\item{startOffsetDays}{Days to add to anchor date for window start (can be negative)}

\item{endOffsetDays}{Days to add to anchor date for window end}

\item{restrictVisitConceptIds}{Optional vector of visit concept IDs to restrict analysis}

\item{eventFilters}{Optional list of event filters, each with name, domain, and conceptIds}

\item{microCosting}{Logical; if TRUE, performs line-level costing at visit detail level}

\item{costConceptId}{Concept ID for cost type (default: 31978 for total charge)}

\item{currencyConceptId}{Concept ID for currency (default: 44818668 for USD)}

\item{primaryEventFilterName}{For micro-costing, name of primary event filter}

\item{targetDialect}{SQL dialect to use (auto-detected if NULL)}

\item{tempEmulationSchema}{Schema for temporary tables (if needed)}

\item{asPermanent}{Keep helper tables after execution?}

\item{returnFormat}{Return results as "tibble" or "list" (includes diagnostics)}

\item{verbose}{Print progress messages?}

\item{logger}{Optional logger object for detailed logging}

\item{cpiAdjustment}{Logical; if TRUE, adjusts costs for inflation using CPI}

\item{cpiTargetYear}{Target year for CPI standardization (default: current year)}

\item{cpiDataPath}{Path to custom CPI data CSV (default: use package data)}
}
\value{
Andromeda object with results

If returnFormat = "tibble": A tibble with cost and utilization metrics
If returnFormat = "list": A list with results and diagnostics tibbles
}
\description{
Performs cost-of-care analysis for a specified cohort, calculating total costs
and utilization rates within a defined time window.

Performs cost-of-care analysis for a specified cohort, calculating total costs
and utilization rates within a defined time window. Supports CPI adjustment
for inflation standardization.
}
\examples{
\dontrun{
connection <- DatabaseConnector::connect(connectionDetails)

results <- calculateCostOfCare(
  connection = connection,
  cdmDatabaseSchema = "cdm_schema",
  cohortDatabaseSchema = "results_schema",
  cohortTable = "cohort",
  cohortId = 1,
  anchorCol = "cohort_start_date",
  startOffsetDays = -365,
  endOffsetDays = 0
)

DatabaseConnector::disconnect(connection)
}

\dontrun{
connection <- DatabaseConnector::connect(connectionDetails)

# Basic analysis
results <- calculateCostOfCare(
  connection = connection,
  cdmDatabaseSchema = "cdm_schema",
  cohortDatabaseSchema = "results_schema",
  cohortTable = "cohort",
  cohortId = 1,
  anchorCol = "cohort_start_date",
  startOffsetDays = -365,
  endOffsetDays = 0
)

# With CPI adjustment to 2023 dollars
resultsAdjusted <- calculateCostOfCare(
  connection = connection,
  cdmDatabaseSchema = "cdm_schema",
  cohortDatabaseSchema = "results_schema",
  cohortTable = "cohort",
  cohortId = 1,
  anchorCol = "cohort_start_date",
  startOffsetDays = -365,
  endOffsetDays = 0,
  cpiAdjustment = TRUE,
  cpiTargetYear = 2023
)

DatabaseConnector::disconnect(connection)
}

}
