% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EunomiaTestHelpers.R
\name{transformCostToCdmV5dot5}
\alias{transformCostToCdmV5dot5}
\title{Transform Wide-Format Cost Table to OMOP CDM v5.5 Long Format}
\usage{
transformCostToCdmV5dot5(
  connectionDetails,
  cdmDatabaseSchema = "main",
  sourceCostTable = "cost"
)
}
\arguments{
\item{connectionDetails}{An object of class \code{connectionDetails} as created by the DatabaseConnector package.}

\item{cdmDatabaseSchema}{Name of the database schema containing the OMOP CDM instance. Defaults to \code{"main"}.}

\item{sourceCostTable}{Name of the wide-format cost table to transform. Defaults to \code{"cost"}.}
}
\value{
Invisibly returns the database connection after successful execution.
}
\description{
Transforms a wide-format \code{cost} table (common in OMOP CDM v5.3 and earlier) into the standard long format required in CDM v5.4+.
This includes backing up the original table and inserting a new, long-format version.
}
\details{
This function performs the following:
\enumerate{
\item Loads the wide-format \code{cost} table (e.g., from \code{injectCostData()}), as well as associated \code{payer_plan_period} information.
\item Maps cost event records to their corresponding domain-specific visit and date information.
\item Transforms wide columns (e.g., \code{total_cost}, \code{paid_by_payer}, etc.) into long-form rows using standard \code{cost_concept_id} mappings.
\item Appends newly required CDM v5.4 fields (e.g., \code{incurred_date}, \code{cost_type_concept_id}, etc.).
\item Backs up the original \code{cost} table as \code{cost_v5_3_backup} and overwrites it with the new long-format version.
}

Only non-zero and valid cost entries are included in the final result.
}
