% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eunomiaDuckDb.R
\name{transformCostToCdmV5dot5}
\alias{transformCostToCdmV5dot5}
\title{Transform Wide-Format COST to CDM v5.5 Long (Normalized) Structure}
\usage{
transformCostToCdmV5dot5(
  connection,
  cdmDatabaseSchema = "main",
  sourceCostTable = "cost"
)
}
\arguments{
\item{connection}{A live DBI connection to a DuckDB database.}

\item{cdmDatabaseSchema}{OMOP CDM schema/database. Default: "main".}

\item{sourceCostTable}{Name of the (wide) COST table to transform. Default: "cost".}
}
\value{
Returns the open DBI \code{connection} (invisibly).
}
\description{
Backs up the wide-format \code{cost} table to \verb{\{schema\}.cost_v5_3_backup}, creates a new
v5.5-compliant \code{cost} table, and populates it by pivoting cost components into
normalized rows with \code{cost_concept_id}.
}
\examples{
\dontrun{
# Assumes you have a DuckDB file with the Eunomia CDM
databaseFile <- getEunomiaDuckDb()
con <- DBI::dbConnect(duckdb::duckdb(databaseFile))

# Run the transformation
transformCostToCdmV5dot5(con)

# Disconnect
DBI::dbDisconnect(con, shutdown = TRUE)
}
}
